---
slug: introducing-tanstack-react-query-client
title: Introducing the new TanStack React Query integration
authors: [juliusmarminge, nicklucas]
---

We are excited to announce the new TanStack React Query integration for tRPC is now available on tRPC's `next`-release. Compared to our classic [React Query Integration](/docs/client/react) it's simpler and more TanStack Query-native, choosing to utilize the [QueryOptions](https://tanstack.com/query/latest/docs/framework/react/guides/query-options) and [MutationOptions](https://tanstack.com/query/latest/docs/framework/react/guides/mutations) interfaces native to TanStack React Query, instead of wrapping `useQuery` and `useMutation` with our own client.

{/* truncate */}

```tsx title="greeting.tsx"
import { useQuery } from '@tanstack/react-query';
import { useTRPC } from './trpc';

export function Greeting() {
  const trpc = useTRPC();

  const greetingQuery = useQuery(trpc.greeting.queryOptions({ name: 'Jerry' }));

  // greetingQuery.data === 'Hello Jerry'

  // [...]
}
```

With this new client we're removing a layer of abstraction which is a common source of confusion for new users, and instead providing a more direct way to work with TanStack React Query which will feel immediately familiar to those who are following TanStack's own [documentation](https://tanstack.com/query/latest). It also means we need less tRPC documentation to explain it, though we of course have [documentation to get you started](/docs/tanstack-react-query/introduction).

You can read our original RFC behind this change [here](https://github.com/trpc/trpc/discussions/6240).

## What's happening to the classic tRPC React Query integration?

It's not going anywhere soon! We're committing to maintaining it for a long time to come, but it won't recieve any significant new features.

We recommend new projects start with the new TanStack React Query integration, and existing projects to consider migrating over gradually.

## How do I migrate?

There are a few approaches to migrate over, but you will probably want to try a combination of:

### Codemod migration

We're working on a codemod to help you migrate your existing codebase over to the new client. This is already available to try but we need your feedback and contributions to improve it. Codemods are very tricky to get right so we're looking for your help to make it as effective as possible.

You can find docs on how to use the codemod [here](/docs/client/tanstack-react-query/codemod).

### Gradual migration

Start by using the new TanStack React Query integration in new parts of your application, and gradually migrate over existing parts as you see fit. Query Keys are identical which means you can use the new client and classic client together and still rely on TanStack Query's caching.

#### Migrating Queries

A classic query might look like this

```tsx
import { trpc } from './trpc';

function Users() {
  const greetingQuery = trpc.greeting.useQuery({ name: 'Jerry' });

  // greetingQuery.data === 'Hello Jerry'
}
```

and changes to

```tsx
import { useQuery } from '@tanstack/react-query';
import { useTRPC } from './trpc';

function Users() {
  const trpc = useTRPC();

  const greetingQuery = useQuery(trpc.greeting.queryOptions({ name: 'Jerry' }));

  // greetingQuery.data === 'Hello Jerry'
}
```

#### Migrating Mutations

A classic mutation might look like this

```tsx
import { trpc } from './trpc';

function Users() {
  const createUserMutation = trpc.createUser.useMutation();

  createUserMutation.mutate({ name: 'Jerry' });
}
```

and changes to

```tsx
import { useMutation } from '@tanstack/react-query';
import { useTRPC } from './trpc';

function Users() {
  const trpc = useTRPC();

  const createUserMutation = useMutation(trpc.createUser.mutationOptions());

  createUserMutation.mutate({ name: 'Jerry' });
}
```
